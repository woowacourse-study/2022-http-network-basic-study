# 웹 서버의 설정이나 설계 미비로 인한 취약성

## 강제 브라우징(Forced Browsing)

웹 서버에는 공개 디렉토리에는 있지만 공개 의도가 없는 파일이 있을 수 있다. 강제 브라우징은 이러한 파일들을 강제로 노출시키는 공격이다.
- 고객 정보 등 중요 정보 누설
- 액세스 권한이 없는 사용자에게 정보 누설
- 링크되지 않은 파일 누설

공개 의도가 없는 리소스에 대한 URL을 숨기는 보안 대책에만 의존하는 경우, 해당 리소스의 URL을 알게 되면 열람할 수 있게 되어 강제 브라우징 공격을 당할 수 있다.
예측하기 쉬운 파일이나 디렉토리의 인덱스가 유출된 경우, 어떤 방법으로든 URL이 유출된 경우에 발생할 수 있다.

또한 인증이 필요한 페이지에서 이용되는 HTML 파일이나 이미지, PDF등의 문서, CSS, 기타 데이터 등의 URL을 알면 권한을 얻지 않고도 해당 리소스에 접근할 수 있다.

## 부적절한 에러 메시지 처리(Error Handling Vulnerability)

공격자에게 유익한 정보가 웹 애플리케이션의 에러 메시지에 포함되는 취약성이다. 예를 들어,
- 웹 애플리케이션에 의한 에러 메시지
- 데이터베이스 등의 시스템에 의한 에러 메시지

와 같이 상세한 에러 메시지가 사용자에게도 보여진다면, 공격자는 이를 이용해 공격에 활용할 수 있다.

### 웹 애플리케이션에 의한 에러 메시지
예를 들어 로그인 실패 시, ID가 존재하면 패스워드가 잘못되었다고 보여주고 ID가 존재하지 않으면 ID가 없다고 표시한다면 ID가 존재 유무에 대한 힌트가 될 수 있다.

### 데이터베이스 등의 시스템에 의한 에러 메시지
데이터베이스 등에서 발생하는 에러 메시지를 서버에서 따로 처리해주지 않고 클라이언트로 그대로 내보내주게 되어 웹 페이지에 그대로 노출된다면, 공격자가 이를 공격에 사용할 수 있게 된다.
예를 들어 SQL 에러 메시지에는 어떤 데이터베이스를 사용하는지 나오고, SQL 문장의 일부도 표시될 수 있기 때문에 SQL 인젝션을 하기 위한 힌트가 될 수 있다. 주로 사용되는 시스템 출력 오류에는
- PHP나 ASP 등의 스크립트 에러
- 데이터베이스나 미들웨어의 에러
- 웹 서버 에러

등이 있다. 이런 에러 메시지가 공격 힌트로 이용되지 않도록 하려면 상세한 에러 메시지를 시스템 차원에서 제한하거나 커스텀 에러 메시지를 만들어서 던져주어야 한다.

## 오픈 리다이렉트(Open Redirect)

오픈 리다이렉트는 지정한 임의의 URL로 리다이렉트하는 공격이다. 이 때, 리다이렉트하는 URL로 악의적인 웹 사이트가 지정된 경우 유저가 해당 사이트로 유도되어 공격당하게 된다. 예를 들어,

```
http://example.com/?redirect=...
```
와 같이 `?redirect=` 뒤의 URL로 리다이렉트하는 기능이 있다고 하면, 공격자가 리다이렉트 파라미터를 공격용 웹 사이트로 고쳐놓는다면 유저는 리다이렉트 파라미터에 지정된 공격 사이트로 유도된다. 이를 이용해서 피싱 사기 등의 공격을 할 수 있는 가능성이 있다.

# 세션 관리 미비로 인한 취약성

세션은 유저의 상태를 관리하기 위한 기능이지만 만약 관리가 취약하다면 유저 인증 상태를 공격자에게 빼앗기게 된다.

## 세션 하이잭(Session Hijack)

공격자가 어떠한 방법으로 유저의 세션 ID를 입수해서 악용하는 것으로, 유저로 위장하는 공격이다. 인증 기능이 있는 웹 애플리케이션에서는 일반적으로 세션 ID로 인증 상태를 관리하는데, 클라이언트에서는 쿠키 등에 세션 ID를 기록하고 서버에서는 세션 ID와 인증 상태를 연동해서 관리한다. 공격자는
- 부적절한 생성 방법에 의한 세션 ID 추측
- 도청이나 XSS 등에 의한 세션 ID 도용
- 세션 고정 공격에 의한 세션 ID 강제

등의 방법으로 세션 ID를 입수해서 공격할 수 있다.

예를 들어, 웹 사이트에 크로스 사이트 스크립팅(XSS) 취약성이 있다면, 공격자는 document.cookie 값을 공격자에게 송신하도록 하는 JavaScript 함정을 설치해서 유저의 쿠키를 가져올 수 있다.
이 쿠키에는 유저의 세션 ID가 들어 있을 것이고 공격 이전에 유저가 인증된 상태라면 당연히 서버에는 해당 세션 ID가 인증되었다는 상태로 되어 있으므로, 공격자는 본인의 쿠키에 이 세션 ID를 세팅함으로써 유저로 위장할 수 있다.

## 세션 픽세이션(Session Fixation)

세션 하이잭이 인증된 유저의 세션 ID를 빼앗는 공격이라면 세션 픽세이션은 유저의 세션 ID를 강제시키고 해당 세션 ID로 인증받도록 하여 공격하는 방식이다.

공격자는 미리 웹 사이트에 액세스 하거나 세션 어댑션(Session Adoption; PHP나 ASP.NET 등에 존재하는 미지의 세션 ID를 받아들이는 기능)을 악용하는 방법으로 공격에 사용할 세션 ID를 준비하고, 유저가 이 세션 ID를 강제로 이용할 수 있도록 함정을 준비한다.
유저가 이 함정에 빠져 해당 세션 ID를 사용한 상태로 인증하게 되면, 공격자가 준비한 세션 ID는 서버상에서 유저가 인증한 상태로 변경된다.
이 세션 ID를 공격자가 이용하게 되면 웹 사이트에 인증된 유저처럼 액세스 할 수 있다.

## 크로스 사이트 리퀘스트 포저리(CSRF, Cross-Site Request Forgeries)

CSRF란 번역하자면 `사이트 간 요청 위조`로 인증된 유저가 공격자의 함정에 의해 의도하지 않은 임의의 액션을 취해 특정 웹 페이지의 보안을 취약하게 하거나 데이터 수정, 삭제 등을 하도록 만드는 공격이다. 다음과 같은 공격이 가능한데,

- 인증된 유저의 권한으로 설정 정보 갱신
- 인증된 유저의 권한으로 상품 구입
- 인증된 유저의 권한으로 게시판에 글 작성

예를 들어, 유저 A가 이미 게시판에 인증된 상태로, 공격자가 함정을 설치한 피싱 사이트에 접속했다고 가정하자. 이 피싱 사이트에는 게시판에 의도하지 않은 코멘트를 추가하는 리퀘스트를 발행하는 함정이 설치되어 있다.
유저 A의 브라우저는 게시판에 인증된 세션 ID를 가지고 있고, 이 상태로 함정에 걸렸기 때문에 유저 A의 권한으로 게시판에 코멘트가 추가된다.

이는 단순히 `게시판에 코멘트 추가` 등의 경우가 아니라 일반 계정을 관리자 계정으로 바꾸거나, 관리자 계정 패스워드를 바꾸는 등 심각한 공격에 이용될 수 있다. (실제 예: 2008년 옥션 개인정보 유출 사건)

CSRF 방지를 위해서는 HTTP 헤더의 Referer를 체크하는 방법(조작이 가능하여 비추천)을 사용하거나 세션에 임의의 난수 값을 저장한 토큰을 저장하고 요청 때 마다 토큰의 난수 정보를 비교하는 방법(CSRF 토큰)을 사용할 수 있다.

# 기타

## 패스워드 크래킹(Password Cracking)

패스워드를 논리적으로 이끌어 내 인증하는 공격으로,
- 네트워크 경유로 패스워드 시행
- 암호화된 패스워드를 해독 (공격자가 암호화나 해시화된 패스워드를 얻었다는 전제)
- SQL 인젝션을 통한 돌파
- 크로스 사이트 스크립팅을 통해 패스워드 훔치기

등의 방법을 사용할 수 있다.

### 네트워크 경유로 패스워드 시행

네트워크 경유로 패스워드 후보를 시험해보는 공격으로는 무차별 대입 공격(Brute-Force Attack), 사전 공격(Dictionary Attack)이 있다.
무차별 대입 공격은 말그대로 모든 경우의 수를 테스트하는 방법으로, 현실적으로 공격 성공 가능성이 높지 않다.
사전 공격은 사전에 패스워드 후보(사전)를 준비해 두고 시험해서 인증을 통과하는 방법으로, 사전에 올바른 패스워드가 없으면 해독할 수 없다.

### 암호화된 패스워드 해독

일반적으로 패스워드는 평문 그대로 보존되지 않고 해시 함수를 통해 해시화나 salt 등의 방법으로 암호화한다. 때문에 공격자가 패스워드 데이터를 훔쳤다 하더라도 이를 해독해서 평문을 사용해야 공격할 수 있다.
암호화된 패스워드를 평문으로 해독하는 방법에는 다음과 같은 것들이 있다.
- 무차별 대입 공격/사전 공격에 의한 유추: 해시 함수를 입수하면 패스워드 후보에 해시 함수를 적용해 해시값을 만들어내서 패스워드를 유추할 수 있다.
- 레인보우 테이블: 평문과 그에 대응하는 해시값으로 구성된 데이터베이스 테이블을 레인보우 테이블이라고 한다. 사전에 거대한 레인보우 테이블을 만들어서 무차별 대입 공격/사전 공격에 사용하면 시간을 단축시킬 수 있다. 공격 성공률을 높이기 위해서는 그만큼 거대한 테이블이 필요하며, FreeRainbowTables에서 배포하고 있는 레인보우 테이블은 대소 영문자와 숫자 1~8 문자로 조합할 수 있는 모든 MD5에 해당하는데 크기가 무려 1050GB다.
- 열쇠 입수: 패스워드가 공통키 암호 등으로 암호화되어 있다면 어떤 방법으로든 공통키를 입수하면 패스워드를 복호화할 수 있다.
- 암호 알고리즘의 취약성을 파고들어 직접 해독: 널리 알려지지 않은 독자적 암호 알고리즘의 경우 검증되지 않은 취약성이 존재할 수 있다.

## 클릭 재킹(Clickjacking)

클릭 재킹은 투명한 버튼이나 링크를 함정 페이지에 심어두고 유저가 클릭하게 해서 의도치 않은 컨텐츠에 액세스 시키는 공격으로, UI Redressing이라고 부르기도 한다.

## DoS 공격(Denial of Service attack)

서비스 제공을 정지 상태로 만드는 공격으로, 웹 사이트 뿐 아니라 네트워크 기기나 서버를 대상으로 공격하는 경우도 있다. 주로
- 액세스를 집중시켜 부하를 걸어 리소스를 다 소비하게 만들어 서비스를 정지 상태로 만든다.
- 취약성을 공격해 서비스를 정지시킨다.

의 방법이 사용되며, 이 중에서도 액세스를 집중시켜서 서비스를 정지시키는 방법은 대량의 액세스를 보낸다는 점에서 단순해 보이지만 정상적인 액세스와 구별하기 힘들어 방지하기 쉽지 않다.
이 DoS 공격을 여러 대의 컴퓨터를 활용해 실행하게 되면 우리가 잘 알고 있는 DDoS 공격(Distrubuted Denial of Service attack)이라고 불리게 된다.

## 백도어(Backdoor)

백도어란 제한된 기능을 정규 절차를 밟지 않고 설치된 뒷문을 지칭하는데, 백도어를 이용하면 본래 정해진 제한을 초과한 기능을 이용할 수 있다. 일반적으로 백도어는
- 개발 단계에 디버그용으로 설치
- 개발자가 본인의 이익과 편의를 위해서 추가
- 공격자의 공격에 의해 설치

의 종류가 있다. 백도어용 프로그램 자체가 설치된 경우에는 프로세스나 통신을 감시해서 발견할 수 있지만, 웹 애플리케이션을 수정해서 설치한 백도어는 정상적으로 이용하는 것과 구별하기 어렵기 때문에 발견하기 쉽지 않다.
백도어는 일반적으로 발각되는 것을 방지하기 위해서 찾기 어렵게 설계되는데, 이를 악용하면 특별한 인증 권한 없이 데이터에 접근, 보안을 해제할 수 있다.
